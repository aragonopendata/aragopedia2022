<ng-container *ngIf="this.tipoLocalidad === 'municipio' || this.tipoLocalidad === 'diputacion'">
    <div class="container template">
        <section class="container breadcrumbs">
            <p *ngIf="this.tipoLocalidad === 'municipio'"><a [routerLink]="['/']">Inicio</a> > Municipio >
                {{this.tituloFicha}}</p>
            <p *ngIf="this.tipoLocalidad === 'diputacion'"><a [routerLink]="['/']">Inicio</a> > Diputación >
                {{this.tituloFicha}}</p>
        </section>
        <section class="container container template__inicio">
            <div class="inicio__img">
                <h1 class="inicio__name">{{this.tituloFicha}} <span *ngIf="this.comunidadActual"
                        class="inicio__name-comunidad">({{this.comunidadActual}})</span></h1>
                <a href={{this.urlMap}} target="_blank">
                    <img *ngIf="this.map" src={{this.map}} alt="Mapa de {{this.tituloFicha}}" width="200" height="280">
                </a>
                <a href={{this.urlMap}} target="_blank" class="btn map_btn">Ver en el mapa</a>
            </div>
            <div class="inicio__data">
                <ul [ngClass]="{'grid-provincias' : this.tipoLocalidad === 'diputacion'}">
                    <li *ngIf="this.sueloUrbano"><a href="{{dataSource.sueloUrbano}}" target="_blank">
                            <mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.sueloUrbano)}}</span>Hectáreas de suelo
                            urbano ({{dataYearExtension}})</a></li>
                    <li *ngIf="this.sueloRural"><a href="{{dataSource.sueloRural}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.sueloRural)}}</span>Hectáreas de suelo
                            rural ({{dataYearExtension}})</a></li>
                    <li><a href="{{dataSource.edificiosDestinadosLocales}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span class="big-number"><span
                                    *ngIf="this.locales">{{format(this.locales)}}</span><span
                                    *ngIf="!this.locales">0</span></span>Edificios destinados a
                            locales (2011)</a></li>
                    <li *ngIf="this.poblacion"><a href="{{dataSource.habitantes}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.poblacion)}}</span>Habitantes ({{yearPoblacion}})</a>
                    </li>
                    <li *ngIf="this.densidadPoblacion && this.tipoLocalidad === 'municipio'"><a
                            href="{{dataSource.densidad}}" target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.densidadPoblacion)}}</span>Habitantes por
                            KM<sup>2</sup></a></li>
                    <li *ngIf="this.poligonos"><a href="{{dataSource.poligonos}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.poligonos)}}</span></a>Polígonos industriales
                    </li>
                    <li *ngIf="this.explotacionesGanaderas"><a href="{{dataSource.explotacionesGanaderas}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.explotacionesGanaderas)}}</span>Explotaciones
                            ganaderas</a></li>
                    <li *ngIf="this.incendiosUltimosAnos"><a href="{{dataSource.incendios}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.incendiosUltimosAnos)}}</span>Incendios desde 2001</a>
                    </li>
                    <li *ngIf="this.hectareasQuemadas"><a href="{{dataSource.hectareasAfectadas}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.hectareasQuemadas)}}</span>Hectáreas afectadas por
                            incendios desde 2001</a></li>
                    <li *ngIf="this.numberOfCreativeWork"><a href="{{dataSource.publicaciones}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.numberOfCreativeWork)}}</span>Menciones
                            en publicaciones</a></li>
                    <li *ngIf="this.plazasHoteleras"><a href="{{dataSource.alojamientosHoteleros}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.plazasHoteleras)}}</span>Alojamientos
                            hoteleros</a></li>
                    <li *ngIf="this.alojamientosTuristicos"><a href="{{dataSource.alojamientosRurales}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.alojamientosTuristicos)}}</span>Alojamientos
                            de turismo rural</a>
                    </li>
                    <li *ngIf="this.municipiosEnTerritorio > 0"><a href="{{dataSource.municipios}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.municipiosEnTerritorio)}}</span>Municipios en
                            el territorio</a>
                    </li>
                </ul>
            </div>
            <div class="inicio__contact">
                <div>
                    <h2 *ngIf="this.direccion">Contacto</h2>
                    <ul>
                        <li *ngIf="this.direccion"><b>Dirección</b> {{this.capitalizeString(this.direccion)}}</li>
                        <li *ngIf="this.localidad"><b>Localidad</b> {{this.capitalizeString(this.localidad)}}</li>
                        <li *ngIf="this.codPostal"><b>Código postal</b> {{this.codPostal}}</li>
                        <li *ngIf="this.telefono"><b>Teléfono</b> <a href="tel:{{this.telefono}}">{{this.telefono}}</a>
                        </li>
                        <li *ngIf="this.email"><b>email</b> <a href="mailto:{{this.email}}">{{this.email}}</a></li>
                    </ul>
                    <a class="data-link" href="{{dataSource.datosContacto}}" target="_blank">Ver origen de los datos</a>
                </div>

                <div *ngIf="this.numeroEntidadesSingulares !== 0">
                    <h2>Entidades singulares</h2>
                    <ul class="entidades">
                        <li class="entidades__item" *ngFor="let entidad of entidadesSingulares">
                            <a href="{{entidad.s.value}}"
                                target="_blank">{{this.capitalizeString(entidad.nombreEntidad.value)}}</a>
                        </li>
                    </ul>
                    <a class="data-link" href="{{dataSource.entidadesSingulares}}" target="_blank">Ver origen de los
                        datos</a>
                </div>
                <div class="template__img-municipio" *ngIf="this.imageWikiDataUrl">
                    <div class="loading" *ngIf="!this.imageWikiDataUrl">
                        <mat-spinner [diameter]="50"></mat-spinner>
                    </div>
                    <figure>
                        <a href="{{this.imageWikiDataUrl}}" target="_blank" rel="nofollow noopener"><img
                                src="{{this.imageWikiDataUrl}}" alt="Imagen principal de {{this.lugarBuscado}}"
                                width="220" height="160"></a>
                        <figcaption>Imagen <a href="{{dataSource.image}}" target="_blank">obtenida de WikiData</a>. Este
                            archivo está disponible bajo la licencia <a
                                href="https://en.wikipedia.org/wiki/es:Creative_Commons" target="_blank"
                                rel="nofollow noopener">Creative Commons</a> <a
                                href="https://creativecommons.org/licenses/by/4.0/deed.es" target="_blank"
                                rel="nofollow noopener">
                                Atribución 4.0
                                Internacional
                            </a>
                        </figcaption>
                    </figure>
                </div>
                <div class="download">
                    <button class="btn btn-download" type="button" (click)="fileDownload()">DESCARGAR FICHA</button>
                </div>
            </div>
        </section>

        <section class="container template__caracteristicas">
            <h2>Características del territorio</h2>
            <div class="caracteristicas__list" *ngIf="this.tipoLocalidad === 'municipio'">
                <a *ngIf="this.porcentajeSueloRural !== undefined && this.porcentajeSueloRural !== 'NaN'"
                    href="{{dataSource.porcentajeSueloRural}}" target="blank">
                    <div class="caracteristica__item">
                        <mat-icon> local_florist</mat-icon> Ocupa un {{this.porcentajeSueloRural}}% del <b>suelo
                            rural</b>
                        de Aragón ({{yearRatioSuelo}})
                    </div>
                </a>
                <a *ngIf="this.porcentajeSueloUrbano !== undefined && this.porcentajeSueloUrbano !== 'NaN'"
                    href="{{dataSource.porcentajeSueloUrbano}}" target="_blank">
                    <div class="caracteristica__item">
                        <mat-icon>zoom_out_map</mat-icon> Ocupa un {{this.porcentajeSueloUrbano}}% del <b>suelo
                            urbano</b>
                        de
                        Aragón ({{yearRatioSuelo}})
                    </div>
                </a>
                <a *ngIf="esPoblado == '1'; else noPoblado" href="{{dataSource.esPoblado}}" target="_blank">
                    <div class="caracteristica__item">
                        <mat-icon>insert_chart_outlined</mat-icon> {{this.tituloFicha}} está entre uno de <b>los 20
                            territorios más
                            poblados</b> de Aragón
                    </div>
                </a>
                <ng-template #noPoblado>
                    <a href="{{dataSource.esPoblado}}" target="_blank">
                        <div class="caracteristica__item">
                            <mat-icon>insert_chart_outlined</mat-icon> {{this.tituloFicha}} no está entre uno de <b>los
                                20
                                territorios más
                                poblados</b> de Aragón
                        </div>
                    </a>
                </ng-template>
                <a *ngIf="this.edadMediaHombres" href="{{dataSource.edadMedia}}" target="_blank">
                    <div class="caracteristica__item">
                        <mat-icon>person</mat-icon> La edad media de los <b>hombres</b> es de
                        {{this.edadMediaHombres}}
                        años ({{yearEdadMedia}})
                    </div>
                </a>
                <a *ngIf="this.edadMediaMujeres" href="{{dataSource.edadMedia}}" target="_blank">
                    <div class="caracteristica__item">
                        <mat-icon>person</mat-icon> La edad media de las <b>mujeres</b> es de
                        {{this.edadMediaMujeres}}
                        años ({{yearEdadMedia}})
                    </div>
                </a>

                <a *ngIf="tieneOficinaComarcal === 0; else noLocales" href="{{dataSource.tieneOficinaComarcal}}"
                    target="_blank">
                    <div class="caracteristica__item">
                        <mat-icon>business</mat-icon> {{this.tituloFicha}} no cuenta con <b>oficina comarcal</b>
                    </div>
                </a>
                <ng-template #noLocales>
                    <a href="{{dataSource.tieneOficinaComarcal}}" target="_blank">
                        <div class="caracteristica__item">
                            <mat-icon>business</mat-icon> {{this.tituloFicha}} cuenta con <b>oficina comarcal</b>
                        </div>
                    </a>
                </ng-template>
            </div>

            <div class="caracteristicas__list" *ngIf="this.tipoLocalidad === 'diputacion'">
                <a *ngIf="this.densidadPoblacion" href="{{dataSource.densidad}}" target="_blank">
                    <div class="caracteristica__item">
                        <mat-icon>people</mat-icon> La densidad de población de <b>La {{this.tituloFicha}}</b> es de
                        {{this.densidadPoblacion}} habitantes por km<sup>2</sup>
                    </div>
                </a>
                <a *ngIf="this.edadMediaHombres" href="{{dataSource.edadMedia}}" target="_blank">
                    <div class="caracteristica__item">
                        <mat-icon>person</mat-icon> La edad media de los <b>hombres</b> es de
                        {{this.edadMediaHombres}}
                        años ({{yearEdadMedia}})
                    </div>
                </a>
                <a *ngIf="this.edadMediaMujeres" href="{{dataSource.edadMedia}}" target="_blank">
                    <div class="caracteristica__item">
                        <mat-icon>person</mat-icon> La edad media de las <b>mujeres</b> es de
                        {{this.edadMediaMujeres}}
                        años ({{yearEdadMedia}})
                    </div>
                </a>
            </div>
        </section>

        <!-- <section class="container template__graphics">
            <div class="graphics__item" style="width: 100%;">
                <app-piramide-poblacion></app-piramide-poblacion>
            </div>
        </section> -->
        <section class="container template__graphics">
            <div class="graphics__item poblacion" style="width: 100%;"
                *ngIf="lineChartData.datasets[0].data.length > 0">
                <div class="tabla">
                    <h2>Últimos datos de Población</h2>
                    <div class="tabla-container">
                        <table class="tabla-poblacion" *ngIf="this.tipoLocalidad === 'municipio'">
                            <tr>
                                <th>Año</th>
                                <td *ngFor="let year of yearsTablaPoblacion"><span>{{year}}</span></td>
                            </tr>
                            <tr>
                                <th>{{this.lugarBuscado}}</th>
                                <td *ngFor="let element of datosDePoblacion">
                                    <span>
                                        {{format(element)}}
                                    </span>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <table class="tabla-poblacion" *ngIf="this.tipoLocalidad === 'diputacion'">
                        <tr>
                            <th>Año</th>
                            <td *ngFor="let year of yearsTablaPoblacion"><span>{{year}}</span></td>
                        </tr>
                        <tr *ngIf="this.municipio[0]">
                            <th>{{this.municipio[0]}}</th>
                            <td *ngFor="let element of tablaPoblacion.slice().reverse()">
                                <span *ngIf="element.nameRefArea.value == this.municipio[0]">
                                    {{format(element.poblac.value)}}
                                </span>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="grafica">
                    <div class="grafica-poblacion" *ngIf="lineChartData.datasets[0].data.length > 0">
                        <h2>Gráfica de los últimos 5 años</h2>
                        <canvas baseChart class="chart" [data]="lineChartData" [options]="lineChartOptions"
                            [type]="lineChartType"></canvas>
                    </div>
                    <a class="data-link" href="{{dataSource.tablaPoblacion}}" target="_blank">Ver origen de los
                        datos</a>
                </div>
            </div>

            <div class="graphics__item presupuestos" *ngIf="presupuestos">
                <h2>Información sobre presupuestos</h2>
                <a href="{{presupuestos}}" target="_blank"
                    class="btn btn-presupuestos"><mat-icon>open_in_new</mat-icon>Ver información de
                    presupuestos</a>
                <a class="data-link" href="{{dataSource.presupuestos}}" target="_blank">Ver origen de los datos</a>
            </div>

            <div *ngIf="this.numberOfCreativeWork !== 0" class="graphics__item" fragment="creative-works">
                <div class="graphics__item-cw">
                    <h2>Enlaces de interés</h2>
                    <p class="big-number"><b>Menciones en publicaciones:</b> {{this.numberOfCreativeWork}} <span
                            *ngIf="numberOfCreativeWork >= 10 || this.tipoLocalidad === 'diputacion'">
                            (Mostrando las
                            últimas 10 publicaciones)
                        </span></p>
                </div>
                <div class="slides">
                    <mat-tab-group mat-align-tabs="start">
                        <mat-tab *ngFor="let link of creativeWork" label="{{link.title.value}}">
                            <span class="slides__tema">
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/turismo'"
                                    href="/results/Turismo">Turismo</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/educacion'"
                                    href="/results/Educacion">Educación</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/ciencia-tecnologia'"
                                    href="/results/Ciencia%20y%20Tecnología">Ciencia y Tecnología</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/empleo'"
                                    href="/results/Empleo">Empleo</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/economia'"
                                    href="/results/Economia">Economía</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/sector-publico'"
                                    href="/results/Sector%20público">Sector Público</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/salud'"
                                    href="/results/Salud">Salud</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/cultura-ocio'"
                                    href="/results/">Cultura y Ocio</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/sociedad-bienestar'"
                                    href="/results/">Sociedad y Bienestar</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/medio-ambiente'"
                                    href="/results/">Medio Ambiente</a>
                            </span>
                            <p class="slides__abstract" *ngIf="leerMas">{{link.resumen.value}} <span class="leer-mas"
                                    (click)="this.leerMas = !this.leerMas"
                                    (keyup.enter)="this.leerMas = !this.leerMas"
                                    (keyup.space)="this.leerMas = !this.leerMas"
                                    tabindex="0" >
                                    Reducir resumen
                                    <mat-icon>keyboard_arrow_up</mat-icon></span></p>
                            <p class=" slides__abstract" *ngIf="leerMas === false">
                                {{this.reduceText(link.resumen.value)}}... <span class="leer-mas"
                                    (click)="this.leerMas = !this.leerMas"
                                    (keyup.space)="this.leerMas = !this.leerMas"
                                    (keyup.enter)="this.leerMas = !this.leerMas" 
                                    tabindex="0">
                                    Ver resumen completo <mat-icon>keyboard_arrow_down</mat-icon></span></p>


                            <a href="{{link.url.value}}" target="_blank" class="slide__link">Leer más</a>
                        </mat-tab>
                    </mat-tab-group>
                </div>
            </div>

            <div class="graphics__item miembros" *ngIf="this.cantidadMiembrosPleno !== 0">
                <h2>Miembros del pleno territorial</h2>
                <ul>
                    <li *ngFor="let miembro of miembrosPleno"><b>{{miembro.cargo.value}}: </b>
                        <a
                            [routerLink]="['/persona/', this.createNameForUrl(miembro.persona.value)]">{{miembro.nombrePersona.value}}</a>
                    </li>
                </ul>
                <a class="data-link" href="{{dataSource.miembrosPleno}}" target="_blank">Ver origen de los datos</a>
            </div>
            <div class="graphics__item personas-ilustres" *ngIf="this.cantidadPersonasIlustres !== 0">
                <h2>Personas Ilustres nacidas en {{this.tituloFicha}} (<a href="{{dataSource.personasIlustres}}"
                        target="_blank">Obtenido de WikiData</a> bajo licencia CC 4.0.0)
                </h2>
                <ul>
                    <li *ngFor="let persona of personasIlustres"><a href="{{persona.about.value}}"
                            target="_blank">{{persona.itemLabel.value}}</a></li>
                </ul>
            </div>
        </section>

        <section class="container template__statistics">
            <h2>Encuentra los datos estadísticos de {{this.tituloFicha}}</h2>
            <!-- <app-aragopedia-selector-temas [selectedMunicipioNombre]="'Ababuj'"></app-aragopedia-selector-temas> -->
            <form [formGroup]="formGroup">
                <div class="selector-temas">
                    <mat-form-field class="temas">
                        <mat-label>
                            Seleccionar datos
                        </mat-label>
                        <input formControlName="tema" [(ngModel)]="selectedTema" matInput [formControl]="temasControl"
                            type="select" [matAutocomplete]="auto" />
                        <mat-autocomplete #auto="matAutocomplete">
                            <mat-option *ngFor="let tema of filteredTemas" 
                                (click)="temaSelected(tema)"
                                (keyup)="temaSelected(tema)"
                                [value]="tema.nombre.value">
                                {{tema.nombre.value}}
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
                </div>
            </form>
            <div>
                <h3 class="datos-seleccionados" [ngClass]="{'hidden': this.displayTema === ''}"><b>Datos
                        seleccionados:</b><br>
                    <span class="underline">{{displayTema}}</span>
                </h3>
                <p [ngClass]="{'errorTabla' : !this.errorTabla}">No se encontraron datos</p>
                <div class="loading" *ngIf="loading">
                    <mat-spinner [diameter]="70"></mat-spinner>
                </div>
                <app-aragopedia-tabla-datos
                    [ngClass]="{'errorTabla' : this.errorTabla, 'hidden': this.displayTema === '' || loading}"
                    class="tabla-datos">
                </app-aragopedia-tabla-datos>
            </div>
        </section>

    </div>
    <div class="return">
        <button class="btn return__btn" [routerLink]="['/']"><mat-icon>keyboard_arrow_left</mat-icon><span
                class="return__text">Nueva búsqueda</span></button>
    </div>
</ng-container>


<!-- Ficha de COMARCA -->

<ng-container *ngIf="this.tipoLocalidad === 'comarca'">
    <div class="container template">
        <section class="container breadcrumbs">
            <p><a [routerLink]="['/']">Inicio</a> > {{this.capitalizeString(this.tipoLocalidad)}}>
                {{this.tituloFicha}}</p>
        </section>
        <section class="container container template__inicio">
            <div class="inicio__img">
                <h1 class="inicio__name">{{this.tituloFicha}}</h1>
                <a href={{this.urlMap}} target="_blank">
                    <mat-spinner [ngClass]="{'spinnerHide':this.map}"></mat-spinner>
                    <img src={{this.map}} alt="Mapa">
                </a>
                <a href={{this.urlMap}} target="_blank" class="btn map_btn">Ver en el mapa</a>
            </div>
            <div class="inicio__data" [ngClass]="{'central-datos': this.tituloFicha === 'Central'}">
                <ul>
                    <li *ngIf="this.sueloUrbano"><a href="{{dataSource.sueloUrbano}}" target="_blank">
                            <mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.sueloUrbano)}}</span>Hectáreas de suelo
                            urbano ({{dataYearExtension}})</a></li>
                    <li *ngIf="this.sueloRural"><a href="{{dataSource.sueloRural}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.sueloRural)}}</span>Hectáreas de suelo
                            rural ({{dataYearExtension}})</a></li>
                    <li *ngIf="this.locales"><a href="{{dataSource.edificiosDestinadosLocales}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.locales)}}</span>Edificios destinados a
                            locales (2011)</a></li>
                    <li *ngIf="this.poblacion"><a href="{{dataSource.habitantes}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.poblacion)}}</span>Habitantes ({{yearPoblacion}})</a>
                    </li>
                    <!-- <li *ngIf="this.densidadPoblacion"><a href="{{dataSource.densidad}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.densidadPoblacion)}}</span>Habitantes por
                            KM<sup>2</sup></a></li> -->
                    <li *ngIf="this.poligonos"><a href="{{dataSource.poligonos}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.poligonos)}}</span></a>Polígonos industriales
                    </li>
                    <li *ngIf="this.explotacionesGanaderas"><a href="{{dataSource.explotacionesGanaderas}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.explotacionesGanaderas)}}</span>Explotaciones
                            ganaderas</a></li>
                    <li *ngIf="this.incendiosUltimosAnos"><a href="{{dataSource.incendios}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.incendiosUltimosAnos)}}</span>Incendios desde 2001</a>
                    </li>
                    <li *ngIf="this.hectareasQuemadas"><a href="{{dataSource.hectareasAfectadas}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.hectareasQuemadas)}}</span>Hectáreas afectadas por
                            incendios desde 2001</a></li>
                    <li *ngIf="this.numberOfCreativeWork"><a href="{{dataSource.publicaciones}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.numberOfCreativeWork)}}</span>Menciones
                            en publicaciones</a></li>
                    <li *ngIf="this.plazasHoteleras"><a href="{{dataSource.alojamientosHoteleros}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.plazasHoteleras)}}</span>Alojamientos
                            hoteleros</a></li>
                    <li *ngIf="this.alojamientosTuristicos"><a href="{{dataSource.alojamientosRurales}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.alojamientosTuristicos)}}</span>Alojamientos
                            de turismo rural</a>
                    </li>
                    <li *ngIf="this.municipiosEnTerritorio > 0"><a href="{{dataSource.municipios}}"
                            target="_blank"><mat-icon>open_in_new</mat-icon><span
                                class="big-number">{{format(this.municipiosEnTerritorio)}}</span>Municipios en
                            el territorio</a>
                    </li>
                </ul>

            </div>
            <div *ngIf="this.direccion || this.imageWikiDataUrl" class="inicio__contact">
                <h2 *ngIf="this.direccion">Contacto</h2>
                <ul>
                    <li *ngIf="this.direccion"><b>Dirección</b> {{this.capitalizeString(this.direccion)}}</li>
                    <li *ngIf="this.localidad"><b>Localidad</b> {{this.capitalizeString(this.localidad)}}</li>
                    <li *ngIf="this.codPostal"><b>Código postal</b> {{this.codPostal}}</li>
                    <li *ngIf="this.telefono"><b>Teléfono</b> <a href="tel:{{this.telefono}}">{{this.telefono}}</a></li>
                    <li *ngIf="this.email"><b>email</b> <a href="mailto:{{this.email}}">{{this.email}}</a></li>
                </ul>
                <a class="data-link" href="{{dataSource.datosContacto}}" target="_blank">Ver origen de los datos</a>
                <div class="template__img-municipio" *ngIf="this.imageWikiDataUrl">
                    <div class="loading" *ngIf="!this.imageWikiDataUrl">
                        <mat-spinner [diameter]="50"></mat-spinner>
                    </div>
                    <figure>
                        <a href="{{this.imageWikiDataUrl}}" target="_blank" rel="nofollow noopener"><img
                                src="{{this.imageWikiDataUrl}}" alt="Imagen principal de {{this.lugarBuscado}}"></a>
                        <figcaption><a href="{{dataSource.image}}" target="_blank">Imagen obtenida de WikiData</a>. Este
                            archivo está disponible bajo la licencia <a
                                href="https://en.wikipedia.org/wiki/es:Creative_Commons" target="_blank"
                                rel="nofollow noopener">Creative Commons</a> <a
                                href="https://creativecommons.org/licenses/by/4.0/deed.es" target="_blank"
                                rel="nofollow noopener">
                                Atribución 4.0
                                Internacional
                            </a>
                        </figcaption>
                    </figure>
                </div>
                <div class="download">
                    <button class="btn btn-download" type="button" (click)="fileDownload()">DESCARGAR FICHA</button>
                </div>
            </div>
        </section>

        <section class="container template__caracteristicas">
            <h2>Características del territorio</h2>
            <div class="caracteristicas__list">
                <a *ngIf="this.densidadPoblacion" href="{{dataSource.densidad}}" target="_blank">
                    <div class="caracteristica__item">
                        <mat-icon>people</mat-icon> La densidad de población de <b>{{this.tituloFicha}}</b> es de
                        {{this.densidadPoblacion}} habitantes por km<sup>2</sup>
                    </div>
                </a>
                <a *ngIf="this.edadMediaHombres" href="{{dataSource.edadMedia}}" target="_blank">
                    <div class="caracteristica__item">
                        <mat-icon>person</mat-icon> La edad media de los <b>hombres</b> es de
                        {{this.edadMediaHombres}}
                        años ({{yearEdadMedia}})
                    </div>
                </a>
                <a *ngIf="this.edadMediaMujeres" href="{{dataSource.edadMedia}}" target="_blank">
                    <div class="caracteristica__item">
                        <mat-icon>person</mat-icon> La edad media de las <b>mujeres</b> es de
                        {{this.edadMediaMujeres}}
                        años ({{yearEdadMedia}})
                    </div>
                </a>
            </div>
        </section>

        <section class="container template__graphics">
            <div class="graphics__item poblacion" style="width: 100%;">
                <div class="tabla">
                    <h2>Últimos datos de Población</h2>
                    <div class="tabla-container">
                        <table class="tabla-poblacion">
                            <tr>
                                <th>Año</th>
                                <td *ngFor="let year of yearsTablaPoblacion"><span>{{year}}</span></td>
                            </tr>
                            <tr *ngIf="this.municipio[0]">
                                <th>{{this.municipio[0]}}</th>
                                <td *ngFor="let element of tablaPoblacion.slice().reverse()">
                                    <span *ngIf="element.nameRefArea.value == this.municipio[0]">
                                        {{format(element.poblac.value)}}
                                    </span>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="grafica">
                    <div class="grafica-poblacion">
                        <h2>Gráfica de los últimos 5 años</h2>
                        <canvas baseChart class="chart" [data]="lineChartData" [options]="lineChartOptions"
                            [type]="lineChartType"></canvas>
                    </div>
                    <a class="data-link" href="{{dataSource.tablaPoblacion}}" target="_blank">Ver origen de los
                        datos</a>
                </div>
            </div>
        </section>



        <section class="container template__graphics">
            <div class="graphics__item presupuestos" *ngIf="presupuestos">
                <h2>Información sobre presupuestos</h2>
                <a href="{{presupuestos}}" target="_blank"
                    class="btn btn-presupuestos"><mat-icon>open_in_new</mat-icon>Ver información de
                    presupuestos</a>
                <a class="data-link" href="{{dataSource.presupuestos}}" target="_blank">Ver origen de los datos</a>
            </div>
            <div *ngIf="this.numberOfCreativeWork" class="graphics__item" fragment="creative-works">
                <div class="graphics__item-cw">
                    <h2>Enlaces de interés</h2>
                    <p class="big-number"><b>
                        </b><b>Menciones en publicaciones:</b> {{format(this.numberOfCreativeWork)}} <span
                            *ngIf="this.numberOfCreativeWork >= 10"> (Mostrando las 10 últimas publicaciones)</span></p>
                </div>
                <div class="slides">
                    <mat-tab-group mat-align-tabs="start">
                        <mat-tab *ngFor="let link of creativeWork" label="{{link.title.value}}">
                            <span class="slides__tema">
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/turismo'"
                                    href="{{link.tema.value}}" target="_blank">Turismo</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/educacion'"
                                    href="{{link.tema.value}}" target="_blank">Educación</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/ciencia-tecnologia'"
                                    href="{{link.tema.value}}" target="_blank">Ciencia y Tecnología</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/empleo'"
                                    href="{{link.tema.value}}" target="_blank">Empleo</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/economia'"
                                    href="{{link.tema.value}}" target="_blank">Economia</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/sector-publico'"
                                    href="{{link.tema.value}}" target="_blank">Sector Público</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/salud'"
                                    href="{{link.tema.value}}" target="_blank">Salud</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/cultura-ocio'"
                                    href="{{link.tema.value}}" target="_blank">Cultura y Ocio</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/sociedad-bienestar'"
                                    href="{{link.tema.value}}" target="_blank">Sociedad y Bienestar</a>
                                <a *ngIf="
                                link.tema.value==='http://datos.gob.es/kos/sector-publico/sector/medio-ambiente'"
                                    href="{{link.tema.value}}" target="_blank">Medio Ambiente</a>
                            </span>
                            <p class="slides__abstract" *ngIf="leerMas">{{link.resumen.value}} <span class="leer-mas"
                                    (click)="this.leerMas = !this.leerMas"
                                    (keyup.enter)="this.leerMas = !this.leerMas"
                                    (keyup.space)="this.leerMas = !this.leerMas"
                                    tabindex="0" > Reducir resumen</span></p>
                            <p class=" slides__abstract" *ngIf="leerMas === false">
                                {{this.reduceText(link.resumen.value)}}... <span class="leer-mas"
                                    (click)="this.leerMas = !this.leerMas"
                                    (keyup.enter)="this.leerMas = !this.leerMas"
                                    (keyup.space)="this.leerMas = !this.leerMas"
                                    tabindex="0" >Ver resumen completo</span></p>


                            <a href="{{link.url.value}}" target="_blank" class="slide__link">Leer más</a>
                        </mat-tab>
                    </mat-tab-group>
                </div>
            </div>
            <div class="graphics__item miembros" *ngIf="this.cantidadMiembrosPleno !== 0">
                <h2>Miembros del pleno territorial</h2>
                <ul>
                    <li *ngFor="let miembro of miembrosPleno"><b>{{miembro.cargo.value}}: </b>
                        <a
                            [routerLink]="['/persona/', this.createNameForUrl(miembro.persona.value)]">{{miembro.nombrePersona.value}}</a>
                    </li>
                </ul>
                <a class="data-link" href="{{dataSource.miembrosPleno}}" target="_blank">Ver origen de los datos</a>
            </div>

        </section>

        <section class="container template__statistics">
            <h2>Encuentra los datos estadísticos de {{this.lugarBuscado}}</h2>
            <form [formGroup]="formGroup">
                <div class="selector-temas">
                    <mat-form-field class="temas">
                        <mat-label>
                            Seleccionar datos
                        </mat-label>
                        <input formControlName="tema" [(ngModel)]="selectedTema" matInput [formControl]="temasControl"
                            type="select" [matAutocomplete]="auto" />
                        <mat-autocomplete #auto="matAutocomplete">
                            <mat-option *ngFor="let tema of filteredTemas" 
                                (click)="temaSelected(tema)"
                                (keyup)="temaSelected(tema)"
                                [value]="tema.nombre.value">
                                {{tema.nombre.value}}
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
                </div>
            </form>
            <div>
                <h3 class="datos-seleccionados" [ngClass]="{'hidden': this.displayTema === ''}"><b>Datos
                        seleccionados:</b><br>
                    <span class="underline">{{displayTema}}</span>
                </h3>
                <p [ngClass]="{'errorTabla' : !this.errorTabla}">No se encontraron datos</p>
                <div class="loading" *ngIf="loading">
                    <mat-spinner [diameter]="70"></mat-spinner>
                </div>
                <app-aragopedia-tabla-datos
                    [ngClass]="{'errorTabla' : this.errorTabla, 'hidden': this.displayTema === '' || loading}"
                    class="tabla-datos">
                </app-aragopedia-tabla-datos>
            </div>
        </section>

    </div>

    <div class="return">
        <button class="btn return__btn" [routerLink]="['/']"><mat-icon>keyboard_arrow_left</mat-icon><span
                class="return__text">Nueva búsqueda</span></button>
    </div>
</ng-container>

<!-- Ficha de PROVINCIA -->